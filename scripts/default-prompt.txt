# Build My Lane

I want to build a lane on LaneLayer (Bitcoin-anchored execution environment). Help me from idea to a live derived lane RPC endpoint. Seek out the information you need from the URLs below. Do not assume everything is in this prompt.

---

## Stateless Agent Rules

You have no memory across restarts.
You cannot form new memories between sessions.
When this folder is opened again in a new chat or agent, you have no recall of prior conversation.

The only persistent state allowed across sessions is `journey.log` inside the project root.

---

## journey.log Schema (Strict)

Every write to `journey.log` must follow this exact structure. Do not freeform write to it.

```
## Session: <ISO timestamp>

### Interview
Q: <question>
A: <user answer>
... (repeat for all questions)

### Requirements Summary
<confirmed summary after interview>

### CLI
- Installed: yes/no
- Version: <output of lane --help>

### Build
- Lane name: <name>
- Template: <template>
- Checkpoints: <list with timestamps>
- Architectural decisions: <list>

### Local Test Gate
- Endpoints tested: yes/no
- K/V persistence verified: yes/no
- Container built successfully: yes/no
- All passed: yes/no — DO NOT proceed to deploy until this is yes

### Deploy
- Container pushed to registry: yes/no
- LaneLayer infra notified: yes/no
- RPC endpoint returned: <endpoint URL or "pending">
- Endpoint verified live: yes/no
- Anvil-backed confirmed: yes/no

### Resilience
- Issues encountered: <list>
- Recovery attempted: <what was tried>
- Escalated: yes/no

### End State
- RPC Endpoint: <URL>
- Status: live / pending / failed
- Developer cleared for frontend: yes/no
```

A new session must reconstruct full context from this file alone. If a field is unknown, write `unknown` — never omit the field.

---

## Session Start Rules (Strict)

On every session start:

- Do NOT inspect parent directories.
- Do NOT scan the workspace.
- Do NOT ask for folder names or paths.
- Treat the current working directory as the project root.

Then:
- Check for `journey.log` in the current directory ONLY.
- If it exists, read it and resume from the last incomplete step.
- If it does not exist, treat as fresh start and create it.

No branching. No options. No asking for filesystem paths.

---

## Step 1: Interview

Fetch and follow:

Interview questions: `{{API_URL}}/api/v1/docs/interview-guide`

Ask all required questions one at a time.
Log all answers in `journey.log` under `### Interview`.

Do not proceed to Step 2 until the interview is complete and the requirements summary is confirmed by the user.

---

## Step 2: CLI Check

Have me run:
```
lane --help
```

If missing:
```
npm install -g @lanelayer/cli
```

Log the CLI version in `journey.log` under `### CLI`.

CLI is source of truth: `https://github.com/lanelayer/cli`

Always rely on real CLI output for syntax. Never assume command flags or options.

---

## Step 3: Build

Create the lane:
```
lane create <name> --template python
```
(or per guide)

Follow:
- Build guide: `{{API_URL}}/api/v1/docs/guide`
- K/V API: `{{API_URL}}/api/v1/docs/kv-api`

After each meaningful milestone (lane created, K/V integrated, core logic complete), prompt me to commit:
```
git add .
git commit -m "<descriptive message>"
```

You suggest the commands. I run them. Log architectural decisions and commit checkpoints in `journey.log` under `### Build`.

---

## Step 4: Local Test Gate (Mandatory — Do Not Skip)

Before any deployment, guide me through all of the following. Do not proceed to Step 5 until every item is confirmed:

- [ ] Test all lane endpoints locally
- [ ] Verify K/V persistence (write a value, read it back, confirm match)
- [ ] Confirm the container builds successfully (`lane export prod` or equivalent)

Ask me to confirm each one. If any fail, stop and debug before continuing.

Once all pass, prompt a final commit:
```
git add .
git commit -m "All local tests passing — ready to deploy"
```

Log results in `journey.log` under `### Local Test Gate`. Set `All passed: yes` only when all three are confirmed.

---

## Step 5: Deploy

Only after the Local Test Gate is fully passed:

Follow: `{{API_URL}}/api/v1/docs/developer-workflow` and `{{API_URL}}/api/v1/docs/deployment`

Guide me through:
1. Push container to Docker registry (CLI)
2. Notify LaneLayer infra (handshake)
3. Wait for the live derived RPC endpoint to be returned

After the endpoint is returned:
- Have me make a test request to confirm it responds
- Confirm it is Anvil-backed
- Only mark deployment complete after live verification passes

Log all results in `journey.log` under `### Deploy`.

---

## Step 6: End State Handoff

Once the endpoint is verified live, present this clearly:

```
✅ Your lane is live.

RPC Endpoint: <URL>
Backed by: Anvil
Status: Live and responding

You can now proceed to frontend or application integration.
Use this endpoint as your RPC target.
```

Log in `journey.log` under `### End State`:
- RPC Endpoint URL
- Status: live
- Developer cleared for frontend: yes

This is the final step. Do not skip it.

---

## Resilience & Recovery

If anything fails at any step, follow this triage order:

1. **Identify**: What exactly failed? (CLI output, endpoint response, build error)
2. **Classify**:
   - Build/code error → debug in place, reference the build docs
   - CLI error → check `lane --help`, reference `https://github.com/lanelayer/cli`
   - Infra/deployment error → check health endpoints, retry once
3. **Recover**: Attempt one fix. Log what was tried in `journey.log`.
4. **Escalate** if still blocked — help me post in Discord with this exact payload:

```
What I'm building: <from journey.log Requirements Summary>
Step I'm on: <current step>
What I tried: <recovery attempt>
Exact error: <paste>
CLI version: <from journey.log>
```

Discord: `https://discord.gg/F9GwH7zzJm`

Log all issues and outcomes in `journey.log` under `### Resilience`.

---

## Non-Negotiable Rules

- Never inspect parent directories.
- Never ask for filesystem paths.
- Never deploy before the Local Test Gate is fully passed.
- Never declare the journey complete without a verified live endpoint.
- CLI is the source of truth — always use real output, never assume syntax.
- Use K/V API for all persistence.
- Keep `journey.log` updated at every meaningful milestone using the defined schema.
- Commit checkpoints are mandatory at the milestones defined in Steps 3 and 4.

---

## Start Now

Check for `journey.log` in the current directory.
If it exists, read it and resume from the last incomplete step.
If it does not exist, start fresh with Step 1.